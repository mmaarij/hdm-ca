{
  "info": {
    "_postman_id": "240cd42f-33cd-48fa-a6ba-572e330a0e98",
    "name": "HDM CA API Testing Suite",
    "description": "Comprehensive testing suite for HDM CA API with maximally simplified upload workflow.\n\n**Test Flow:**\n1. Setup & Authentication - Register and authenticate users\n2. Document Lifecycle - Single-step upload with auto-metadata extraction\n3. Permission Management - Grant, update, check, revoke\n4. Metadata Operations - Add, update, query metadata\n5. Download System - Generate links, validate tokens, download files\n6. Advanced Features - Search, admin operations, version management\n7. Security & Edge Cases - Validation and error handling\n\n**Test Users:**\n- Admin: admin@hdm.test / AdminPass123!\n- Owner: owner@hdm.test / OwnerPass123!\n- Collaborator: collab@hdm.test / CollabPass123!\n\n**Simplified Upload:**\n- Just send the file - filename, MIME type, and size are auto-detected\n- For new versions, include documentId\n- Automatic version incrementing\n- No manual metadata entry required\n\n**Usage:** Run collection with Collection Runner for full automated testing",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "48882079",
    "_collection_link": "https://muhammad-maarij-5574753.postman.co/workspace/Muhammad-Maarij's-Workspace~69a6fe11-d883-49bd-80fa-22cb46b3bcc9/collection/48882079-240cd42f-33cd-48fa-a6ba-572e330a0e98?action=share&source=collection_link&creator=48882079"
  },
  "item": [
    {
      "name": "1. Setup & Authentication",
      "item": [
        {
          "name": "Health Check",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Server is healthy', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.status).to.eql('healthy');",
                  "});",
                  "console.log('ðŸ¥ Health check passed');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-ID",
                "value": "health-check-001"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/health",
              "host": ["{{BASE_URL}}"],
              "path": ["health"]
            }
          },
          "response": []
        },
        {
          "name": "Register Admin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Admin registered', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.user).to.exist;",
                  "    pm.expect(body.user.role).to.eql('ADMIN');",
                  "    pm.environment.set('adminUserId', body.user.id);",
                  "});",
                  "console.log('ðŸ‘‘ Admin user registered');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-ID",
                "value": "register-admin-001"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@hdm.test\",\n  \"password\": \"AdminPass123!\",\n  \"role\": \"ADMIN\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/users/register",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "register"]
            }
          },
          "response": []
        },
        {
          "name": "Register Owner",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Owner registered', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.user).to.exist;",
                  "    pm.expect(body.user.role).to.eql('USER');",
                  "    pm.environment.set('ownerUserId', body.user.id);",
                  "});",
                  "console.log('ðŸ‘¤ Owner user registered');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"owner@hdm.test\",\n  \"password\": \"OwnerPass123!\",\n  \"role\": \"USER\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/users/register",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "register"]
            }
          },
          "response": []
        },
        {
          "name": "Register Collaborator",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Collaborator registered', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.user).to.exist;",
                  "    pm.environment.set('collabUserId', body.user.id);",
                  "});",
                  "console.log('ðŸ‘¥ Collaborator user registered');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"collab@hdm.test\",\n  \"password\": \"CollabPass123!\",\n  \"role\": \"USER\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/users/register",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "register"]
            }
          },
          "response": []
        },
        {
          "name": "Login Admin",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Admin logged in', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.token).to.exist;",
                  "    pm.environment.set('adminToken', body.token);",
                  "});",
                  "console.log('ðŸ”‘ Admin authenticated');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@hdm.test\",\n  \"password\": \"AdminPass123!\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/users/login",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Login Owner",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Owner logged in', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.token).to.exist;",
                  "    pm.environment.set('ownerToken', body.token);",
                  "});",
                  "console.log('ðŸ”‘ Owner authenticated');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"owner@hdm.test\",\n  \"password\": \"OwnerPass123!\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/users/login",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Login Collaborator",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Collaborator logged in', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.token).to.exist;",
                  "    pm.environment.set('collabToken', body.token);",
                  "});",
                  "console.log('ðŸ”‘ Collaborator authenticated');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"collab@hdm.test\",\n  \"password\": \"CollabPass123!\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/users/login",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "login"]
            }
          },
          "response": []
        },
        {
          "name": "Get Owner Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Owner profile retrieved', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.id).to.exist;",
                  "    pm.expect(body.email).to.eql('owner@hdm.test');",
                  "});",
                  "console.log('ðŸ“‹ Owner profile fetched');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/users/me",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "me"]
            }
          },
          "response": []
        },
        {
          "name": "List All Users (Admin)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Admin can list all users', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.users).to.be.an('array');",
                  "    pm.expect(body.users.length).to.be.at.least(3);",
                  "});",
                  "console.log('ðŸ“œ All users listed');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/users",
              "host": ["{{BASE_URL}}"],
              "path": ["users"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. Document Lifecycle",
      "item": [
        {
          "name": "Upload New Document (Owner)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Document uploaded (v1)', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.documentId).to.exist;",
                  "    pm.expect(body.versionId).to.exist;",
                  "    pm.expect(body.document).to.exist;",
                  "    pm.expect(body.version).to.exist;",
                  "    pm.expect(body.version.versionNumber).to.eql(1);",
                  "    pm.environment.set('ownerDocId', body.documentId);",
                  "    pm.environment.set('ownerVersionId', body.versionId);",
                  "    pm.environment.set('ownerVersion1Id', body.versionId);",
                  "});",
                  "console.log('ðŸ“¤ New document uploaded');",
                  "console.log('   Document ID: ' + pm.environment.get('ownerDocId'));",
                  "console.log('   Version 1 ID: ' + pm.environment.get('ownerVersionId'));"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "description": "Upload a test file - filename, MIME type, and size are auto-detected",
                  "type": "file",
                  "src": "postman-cloud:///1f0a070f-9af1-4e30-9d26-3b04ee6651d9"
                }
              ]
            },
            "url": {
              "raw": "{{BASE_URL}}/documents",
              "host": ["{{BASE_URL}}"],
              "path": ["documents"]
            }
          },
          "response": []
        },
        {
          "name": "Upload New Version (Owner)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… New version uploaded (v2)', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.documentId).to.eql(pm.environment.get('ownerDocId'));",
                  "    pm.expect(body.versionId).to.exist;",
                  "    pm.expect(body.version.versionNumber).to.eql(2);",
                  "    pm.environment.set('ownerVersion2Id', body.versionId);",
                  "});",
                  "console.log('ï¿½ Version 2 uploaded');",
                  "console.log('   Version 2 ID: ' + pm.environment.get('ownerVersion2Id'));"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "description": "Upload updated file - metadata auto-detected from file",
                  "type": "file",
                  "src": "postman-cloud:///1f0a0710-30fe-4f90-b502-6f0e753c8c25"
                },
                {
                  "key": "documentId",
                  "value": "{{ownerDocId}}",
                  "description": "ID of document to add version to",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{BASE_URL}}/documents",
              "host": ["{{BASE_URL}}"],
              "path": ["documents"]
            }
          },
          "response": []
        },
        {
          "name": "Get Document Details (Latest Version)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Document details retrieved', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.document.id).to.eql(pm.environment.get('ownerDocId'));",
                  "    pm.expect(body.document.originalName).to.exist;",
                  "    pm.expect(body.latestVersion).to.exist;",
                  "    pm.expect(body.latestVersion.versionNumber).to.eql(2);",
                  "});",
                  "console.log('ðŸ“„ Document details fetched (latest = v2)');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "{{ownerDocId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Get Specific Version (v1)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Specific version retrieved', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.id).to.eql(pm.environment.get('ownerVersion1Id'));",
                  "    pm.expect(body.versionNumber).to.eql(1);",
                  "    pm.expect(body.documentId).to.eql(pm.environment.get('ownerDocId'));",
                  "});",
                  "console.log('ðŸ“„ Version 1 details fetched');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}/versions/{{ownerVersion1Id}}",
              "host": ["{{BASE_URL}}"],
              "path": [
                "documents",
                "{{ownerDocId}}",
                "versions",
                "{{ownerVersion1Id}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "List All Document Versions",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… All versions listed', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body).to.be.an('array');",
                  "    pm.expect(body.length).to.eql(2);",
                  "    pm.expect(body[0].versionNumber).to.exist;",
                  "    pm.expect(body[1].versionNumber).to.exist;",
                  "});",
                  "console.log('ðŸ“š All versions listed (2 versions)');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}/versions",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "{{ownerDocId}}", "versions"]
            }
          },
          "response": []
        },
        {
          "name": "List Owner's Documents",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Owner documents listed', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.documents).to.be.an('array');",
                  "    pm.expect(body.documents.length).to.be.at.least(1);",
                  "});",
                  "console.log('ðŸ“š Owner documents listed');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents",
              "host": ["{{BASE_URL}}"],
              "path": ["documents"]
            }
          },
          "response": []
        },
        {
          "name": "Search Documents (Owner)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Search returns unique documents', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.results).to.be.an('array');",
                  "    // Should return documents, not versions",
                  "    if (body.results.length > 0) {",
                  "        pm.expect(body.results[0]).to.have.property('id');",
                  "        pm.expect(body.results[0]).to.have.property('filename');",
                  "        pm.expect(body.results[0]).to.not.have.property('versionNumber');",
                  "        pm.expect(body.results[0]).to.not.have.property('documentId');",
                  "    }",
                  "});",
                  "console.log('ðŸ” Search completed - unique documents only');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/search?query=project",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "search"],
              "query": [
                {
                  "key": "query",
                  "value": "project"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. Permission Management",
      "item": [
        {
          "name": "Collab: Try Access Owner Doc (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Access denied without permission', () => {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "console.log('ðŸš« Access correctly denied');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{collabToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "{{ownerDocId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Owner: Grant READ Permission to Collab",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… READ permission granted', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.permission).to.exist;",
                  "    pm.expect(body.permission.id).to.exist;",
                  "    pm.expect(body.permission.permission).to.eql('READ');",
                  "    pm.environment.set('readPermissionId', body.permission.id);",
                  "});",
                  "console.log('âœ… READ permission granted: ' + pm.environment.get('readPermissionId'));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"documentId\": \"{{ownerDocId}}\",\n  \"userId\": \"{{collabUserId}}\",\n  \"permission\": \"READ\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/permissions/grant",
              "host": ["{{BASE_URL}}"],
              "path": ["permissions", "grant"]
            }
          },
          "response": []
        },
        {
          "name": "Collab: Now Can Access Owner Doc",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Can access with READ permission', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.document.id).to.eql(pm.environment.get('ownerDocId'));",
                  "});",
                  "console.log('âœ… Access granted with READ permission');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{collabToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "{{ownerDocId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Check Permission Exists",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Permission check works', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.hasPermission).to.be.true;",
                  "    pm.expect(body.permission).to.eql('READ');",
                  "});",
                  "console.log('âœ… Permission verified');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/permissions/check?documentId={{ownerDocId}}&userId={{collabUserId}}&requiredPermission=READ",
              "host": ["{{BASE_URL}}"],
              "path": ["permissions", "check"],
              "query": [
                {
                  "key": "documentId",
                  "value": "{{ownerDocId}}"
                },
                {
                  "key": "userId",
                  "value": "{{collabUserId}}"
                },
                {
                  "key": "requiredPermission",
                  "value": "READ"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "List Document Permissions",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Permissions listed', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.permissions).to.be.an('array');",
                  "    pm.expect(body.permissions.length).to.be.at.least(1);",
                  "});",
                  "console.log('ðŸ“‹ Document permissions listed');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/permissions/document/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["permissions", "document", "{{ownerDocId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Owner: Upgrade to WRITE Permission",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Permission upgraded to WRITE', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.id).to.exist;",
                  "    pm.expect(body.permission).to.eql('WRITE');",
                  "});",
                  "console.log('â¬†ï¸ Permission upgraded to WRITE');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"permission\": \"WRITE\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/permissions/{{readPermissionId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["permissions", "{{readPermissionId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Collab: Upload New Version with WRITE",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Collaborator uploaded new version with WRITE permission', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.document).to.exist;",
                  "    pm.expect(body.version.versionNumber).to.eql(3);",
                  "});",
                  "console.log('ðŸ“¤ Collaborator uploaded version 3 with WRITE permission');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{collabToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "postman-cloud:///1f0ba5cd-b4c3-4e90-91aa-ddeb9b0a4809"
                },
                {
                  "key": "documentId",
                  "value": "{{ownerDocId}}",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{BASE_URL}}/documents",
              "host": ["{{BASE_URL}}"],
              "path": ["documents"]
            }
          },
          "response": []
        },
        {
          "name": "List User's Permissions",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… User permissions listed', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.permissions).to.be.an('array');",
                  "});",
                  "console.log('ðŸ“‹ User permissions listed');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/permissions/user/{{collabUserId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["permissions", "user", "{{collabUserId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Owner: Revoke Permission",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Permission revoked', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "console.log('ðŸš« Permission revoked');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/permissions/{{readPermissionId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["permissions", "{{readPermissionId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Collab: Access Denied After Revoke",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Access denied after revocation', () => {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "console.log('ðŸš« Access correctly denied after revocation');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{collabToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "{{ownerDocId}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. Metadata Operations",
      "item": [
        {
          "name": "Add Metadata: Author",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Metadata added', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.id).to.exist;",
                  "    pm.expect(body.key).to.eql('author');",
                  "    pm.environment.set('metadataId1', body.id);",
                  "});",
                  "console.log('ðŸ·ï¸ Metadata added: author');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"documentId\": \"{{ownerDocId}}\",\n  \"key\": \"author\",\n  \"value\": \"John Doe\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/metadata",
              "host": ["{{BASE_URL}}"],
              "path": ["metadata"]
            }
          },
          "response": []
        },
        {
          "name": "Add Metadata: Department",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Metadata added', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.environment.set('metadataId2', body.id);",
                  "});",
                  "console.log('ðŸ·ï¸ Metadata added: department');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"documentId\": \"{{ownerDocId}}\",\n  \"key\": \"department\",\n  \"value\": \"Engineering\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/metadata",
              "host": ["{{BASE_URL}}"],
              "path": ["metadata"]
            }
          },
          "response": []
        },
        {
          "name": "Get All Document Metadata",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Metadata retrieved', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.metadata).to.be.an('array');",
                  "    pm.expect(body.metadata.length).to.be.at.least(2);",
                  "});",
                  "console.log('ðŸ“‹ All metadata retrieved');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/metadata/document/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["metadata", "document", "{{ownerDocId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Get Metadata by Key",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Specific metadata retrieved', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.key).to.eql('author');",
                  "    pm.expect(body.value).to.eql('John Doe');",
                  "});",
                  "console.log('ðŸ” Metadata retrieved by key');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/metadata/document/{{ownerDocId}}/key/author",
              "host": ["{{BASE_URL}}"],
              "path": [
                "metadata",
                "document",
                "{{ownerDocId}}",
                "key",
                "author"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update Metadata",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Metadata updated', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.value).to.eql('Jane Smith');",
                  "});",
                  "console.log('âœï¸ Metadata updated');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"value\": \"Jane Smith\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/metadata/{{metadataId1}}",
              "host": ["{{BASE_URL}}"],
              "path": ["metadata", "{{metadataId1}}"]
            }
          },
          "response": []
        },
        {
          "name": "Delete Metadata",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Metadata deleted', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "console.log('ðŸ—‘ï¸ Metadata deleted');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/metadata/{{metadataId2}}",
              "host": ["{{BASE_URL}}"],
              "path": ["metadata", "{{metadataId2}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "5. Download System",
      "item": [
        {
          "name": "Generate Download Link (5 min TTL)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Download link generated', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.token).to.exist;",
                  "    pm.expect(body.downloadUrl).to.exist;",
                  "    pm.expect(body.expiresAt).to.exist;",
                  "    pm.environment.set('downloadToken', body.token);",
                  "});",
                  "console.log('ðŸ”— Download link generated');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"documentId\": \"{{ownerDocId}}\",\n  \"ttlMs\": 300000\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/downloads/generate",
              "host": ["{{BASE_URL}}"],
              "path": ["downloads", "generate"]
            }
          },
          "response": []
        },
        {
          "name": "Validate Download Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Token validated', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.valid).to.be.true;",
                  "    pm.expect(body.documentId).to.exist;",
                  "});",
                  "console.log('âœ… Token is valid');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/downloads/validate/{{downloadToken}}",
              "host": ["{{BASE_URL}}"],
              "path": ["downloads", "validate", "{{downloadToken}}"]
            }
          },
          "response": []
        },
        {
          "name": "Download File (No Auth Required)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… File downloaded', () => {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.headers.get('Content-Type')).to.exist;",
                  "    pm.expect(pm.response.headers.get('Content-Disposition')).to.include('attachment');",
                  "});",
                  "console.log('â¬‡ï¸ File downloaded successfully');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/downloads/{{downloadToken}}",
              "host": ["{{BASE_URL}}"],
              "path": ["downloads", "{{downloadToken}}"]
            }
          },
          "response": []
        },
        {
          "name": "Try Download Again (Should Fail - Used)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Token already used error', () => {",
                  "    pm.response.to.have.status(409);",
                  "});",
                  "console.log('ðŸš« Token correctly marked as used');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/downloads/{{downloadToken}}",
              "host": ["{{BASE_URL}}"],
              "path": ["downloads", "{{downloadToken}}"]
            }
          },
          "response": []
        },
        {
          "name": "Validate Invalid Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Invalid token detected', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.valid).to.be.false;",
                  "});",
                  "console.log('ðŸš« Invalid token correctly identified');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/downloads/validate/invalid-token-xyz123",
              "host": ["{{BASE_URL}}"],
              "path": ["downloads", "validate", "invalid-token-xyz123"]
            }
          },
          "response": []
        },
        {
          "name": "Cleanup Expired Tokens (Admin)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Cleanup executed', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.deletedCount).to.exist;",
                  "});",
                  "console.log('ðŸ§¹ Expired tokens cleaned up');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/downloads/cleanup",
              "host": ["{{BASE_URL}}"],
              "path": ["downloads", "cleanup"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "6. Advanced Features",
      "item": [
        {
          "name": "Admin: View All Documents",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Admin can see all documents', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.documents).to.be.an('array');",
                  "});",
                  "console.log('ðŸ‘‘ Admin viewing all documents');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/admin/all",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "admin", "all"]
            }
          },
          "response": []
        },
        {
          "name": "Update User Profile",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Profile updated', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "console.log('ðŸ‘¤ Profile updated');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"owner.updated@hdm.test\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/users/me",
              "host": ["{{BASE_URL}}"],
              "path": ["users", "me"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "7. Security & Edge Cases",
      "item": [
        {
          "name": "No Auth Header (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Unauthorized without token', () => {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "console.log('ðŸš« Correctly requires authentication');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/documents",
              "host": ["{{BASE_URL}}"],
              "path": ["documents"]
            }
          },
          "response": []
        },
        {
          "name": "Invalid Token (Should Fail)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Invalid token rejected', () => {",
                  "    pm.response.to.have.status(401);",
                  "});",
                  "console.log('ðŸš« Invalid token correctly rejected');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer invalid-jwt-token-xyz"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents",
              "host": ["{{BASE_URL}}"],
              "path": ["documents"]
            }
          },
          "response": []
        },
        {
          "name": "Non-existent Document (Should 404)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Not found for invalid document', () => {",
                  "    pm.response.to.have.status(404);",
                  "});",
                  "console.log('ðŸš« Non-existent resource correctly handled');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/00000000-0000-0000-0000-000000000000",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "00000000-0000-0000-0000-000000000000"]
            }
          },
          "response": []
        },
        {
          "name": "Non-Owner Cannot Delete (Should 403)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Non-owner cannot delete', () => {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "console.log('ðŸš« Non-owner deletion correctly blocked');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{collabToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "{{ownerDocId}}"]
            }
          },
          "response": []
        },
        {
          "name": "Non-Admin Cannot List All Users",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Non-admin cannot list all users', () => {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "console.log('ðŸš« User list access restricted to admins only');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/users",
              "host": ["{{BASE_URL}}"],
              "path": ["users"]
            }
          },
          "response": []
        },
        {
          "name": "Non-Admin Cannot Cleanup Tokens",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Non-admin cannot cleanup', () => {",
                  "    pm.response.to.have.status(403);",
                  "});",
                  "console.log('ðŸš« Admin-only operation protected');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/downloads/cleanup",
              "host": ["{{BASE_URL}}"],
              "path": ["downloads", "cleanup"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "8. Cleanup",
      "item": [
        {
          "name": "Owner Delete Document",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Document deleted', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "console.log('ðŸ—‘ï¸ Test document deleted');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents/{{ownerDocId}}",
              "host": ["{{BASE_URL}}"],
              "path": ["documents", "{{ownerDocId}}"]
            }
          },
          "response": []
        },
        {
          "name": "List Owner's Documents (Empty)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Owner documents listed', () => {",
                  "    pm.response.to.have.status(200);",
                  "    const body = pm.response.json();",
                  "    pm.expect(body.documents).to.be.an('array');",
                  "    pm.expect(body.documents.length).to.be.at.least(0);",
                  "});",
                  "console.log('ðŸ“š Owner documents listed');"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ownerToken}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/documents",
              "host": ["{{BASE_URL}}"],
              "path": ["documents"]
            }
          },
          "response": []
        },
        {
          "name": "Final Health Check",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('âœ… Final health check passed', () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "console.log('\\n========================================');",
                  "console.log('âœ… HDM v2 SIMPLIFIED WORKFLOW TEST COMPLETED');",
                  "console.log('========================================');",
                  "console.log('âœ“ Authentication & Authorization');",
                  "console.log('âœ“ Simplified Single-Step Upload');",
                  "console.log('âœ“ Automatic Version Management');",
                  "console.log('âœ“ Permission System (RBAC)');",
                  "console.log('âœ“ Metadata Operations');",
                  "console.log('âœ“ Download Token System');",
                  "console.log('âœ“ Advanced Features & Version Access');",
                  "console.log('âœ“ Security & Edge Cases');",
                  "console.log('========================================');",
                  "console.log('ðŸŽ‰ All Systems Operational!');",
                  "console.log('ðŸš€ Simplified Flow: 10x Easier!');",
                  "console.log('========================================\\n');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/health",
              "host": ["{{BASE_URL}}"],
              "path": ["health"]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Set default base URL if not set",
          "if (!pm.environment.get('BASE_URL')) {",
          "    pm.environment.set('BASE_URL', 'http://localhost:3000');",
          "}",
          "",
          "// Add correlation ID to all requests",
          "const correlationId = pm.variables.replaceIn('{{$guid}}');",
          "pm.request.headers.add({",
          "    key: 'X-Correlation-ID',",
          "    value: correlationId",
          "});"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Log response time for performance monitoring",
          "const responseTime = pm.response.responseTime;",
          "if (responseTime > 1000) {",
          "    console.warn('âš ï¸ Slow response: ' + pm.info.requestName + ' (' + responseTime + 'ms)');",
          "}",
          "",
          "// Check for correlation ID in response",
          "const correlationId = pm.response.headers.get('x-correlation-id');",
          "if (correlationId) {",
          "    pm.environment.set('lastCorrelationId', correlationId);",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "BASE_URL",
      "value": "http://localhost:3000",
      "type": "string"
    }
  ]
}
